apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: readarr
  namespace: argocd
  finalizers:
  {{- range .Values.application.finalizers }}
    - {{ . -}}
  {{ end }}
  annotations:
    argocd-image-updater.argoproj.io/image-list: readarr=linuxserver/readarr:1.x
    argocd-image-updater.argoproj.io/readarr.helm.image-name: readarr.image.name
    argocd-image-updater.argoproj.io/readarr.helm.image-tag: readarr.image.tag
    argocd-image-updater.argoproj.io/write-back-method: git:secret:argocd/git-creds
    argocd-image-updater.argoproj.io/git-branch: master
spec:
  destination:
    namespace: readarr
    server: {{ .Values.application.destination.server }}
  project: {{ .Values.application.project }}
  source:
    repoURL: {{ .Values.application.source.repoURL }}
    targetRevision: {{ .Values.application.source.targetRevision }}
    path: cluster/apps/readarr
    helm:
      valueFiles:
        - {{ .Values.application.source.secretsValueFile }}
  syncPolicy:
    automated:
      prune: {{ .Values.application.syncPolicy.prune }}
      selfHeal: {{ .Values.application.syncPolicy.selfHeal }}
    syncOptions:
  {{- range .Values.application.syncOptions }}
    - {{ . -}}
  {{ end }}    
