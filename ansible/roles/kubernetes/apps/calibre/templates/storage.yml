apiVersion: v1
kind: Secret
metadata:
  name: cifs-secret
  namespace: calibre
type: fstab/cifs
stringData:
  username: "{{ secret.cifs.username }}"
  password: "{{ secret.cifs.password }}"
---
apiVersion: v1
kind: PersistentVolume
metadata:
  name: calibre-web-books
spec:
  storageClassName: ""
  capacity:
    storage: 100Gi
  accessModes:
    - ReadWriteMany
  persistentVolumeReclaimPolicy: Retain
  flexVolume:
    driver: fstab/cifs
    fsType: cifs
    secretRef:
      name: cifs-secret
    options:
      networkPath: "//{{ secret.cifs.services_server }}/Calibre"
      mountOptions: "{{ secret.cifs.mount_options }}"
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: calibre-web-books
  namespace: calibre
spec:
  storageClassName: ""
  accessModes:
    - ReadWriteMany
  resources:
    requests:
      storage: 100Gi
# ---
# apiVersion: v1
# kind: Pod
# metadata:
#   name: busybox
#   namespace: calibre
# spec:
#   hostNetwork: true
#   containers:
#   - name: busybox
#     image: busybox
#     command:
#       - sleep
#       - "3600"
#     imagePullPolicy: IfNotPresent
#     volumeMounts:
#     - name: test
#       mountPath: /data
#   volumes:
#   - name: test
#     persistentVolumeClaim:
#         claimName: calibre-books
