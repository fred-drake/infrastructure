- name: get labels
  traefik_labels:
    name: whoogle
    domain: "{{ secret.domain }}"
    port: 5000
  register: tl

- name: whoogle swarm service
  docker_swarm_service:
    name: whoogle
    image: benbusby/whoogle-search:latest
    placement:
      constraints: node.role==worker
    networks:
      - traefik
    publish:
      - published_port: 5000
        target_port: 5000
    labels: "{{ tl.labels }}"