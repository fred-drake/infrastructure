- name: Removal of GlusterFS server nodes
  hosts: glusterfs_server
  become: true
  tasks:
    - name: Warning
      ansible.builtin.pause:
        prompt: "WARNING: This will destroy your volume.  Be sure this is what you want!!  Press ENTER to continue."
    - name: Delete gluster volume
      gluster.gluster.gluster_volume:
        state: absent
        name: vol01
      run_once: true

    - name: Remove trusted storage pool
      gluster.gluster.gluster_peer:
        state: absent
        nodes: "{{ groups['glusterfs'][1:] }}"
      run_once: true
    - name: Remove vol01
      ansible.builtin.file:
        path: /export/brick0/vol01
        state: absent
    # - name: stop glusterfs
    #   systemd:
    #     name: glusterd
    #     enabled: false
    #     state: stopped
