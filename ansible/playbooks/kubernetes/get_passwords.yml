- name: Pull password information for Kubernetes cluster
  hosts: localhost
  gather_facts: true
  become: false
  tasks:
    - name: Get argocd admin password
      ansible.builtin.shell: >
        set -o pipefail && kubectl -n argocd get secret
        argocd-initial-admin-secret -o jsonpath="{['data']['password']}" |
        base64 --decode && echo
      register: shell_output
      changed_when: false

    - name: Print argocd admin password
      ansible.builtin.debug:
        msg: "Argo CD admin password: {{ shell_output.stdout }}"
